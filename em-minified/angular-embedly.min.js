var angularEmbedly=angular.module("angular-embedly",[]);!function(e){e.provider("embedlyService",function(){function e(){return d?"https":"https"}function t(t){this.embed=function(d,o){var r=encodeURI(d),i=e()+"://api.embed.ly/1/oembed?key="+n+"&url="+r;return"undefined"!=typeof o&&(i=i+"&maxwidth="+o),t({method:"GET",url:i})},this.extract=function(d){var o=encodeURI(d),r=e+"://api.embed.ly/1/extract?key="+n+"&url="+o;return t({method:"GET",url:r})}}var n,d;this.setKey=function(e){return n=e},this.getKey=function(){return n},this.secure=function(e){return e?(d=e,void 0):d},this.$get=["$http",function(e){return new t(e)}]})}(angularEmbedly),function(e){e.controller("emEmbedCtrl",["$scope",function(e){e.embedCode=""}])}(angularEmbedly),function(e){e.directive("emEmbed",["embedlyService",function(e){return{restrict:"E",scope:{urlsearch:"@",maxwidth:"@",onempty:"&"},controller:"emEmbedCtrl",link:function(t,n){function d(){void 0!=t.onempty&&"function"==typeof t.onempty&&t.onempty()}t.$parent.loading_embedly=!1,t.$watch("urlsearch",function(o){var r=t.embedCode;o&&(t.$parent.loading_embedly=!0,e.embed(o,t.maxwidth).then(function(e){switch(t.$parent.loading_embedly=!1,e.data.type){case"video":void 0==e.data.html?d():t.embedCode=window.location.protocol.indexOf("file:")>-1?e.data.html.replace('src="//cdn.embedly','src="https://cdn.embedly'):e.data.html;break;case"photo":void 0==e.data.url?d():t.embedCode='<img src="'+e.data.url+'">';break;default:d(),t.embedCode=""}r!==t.embedCode&&n.html("<div>"+t.embedCode+"</div>")},function(){t.$parent.loading_embedly=!1;var e=t.embedCode;t.embedCode="",e!==t.embedCode&&n.html("<div>"+t.embedCode+"</div>")}))})}}}])}(angularEmbedly);